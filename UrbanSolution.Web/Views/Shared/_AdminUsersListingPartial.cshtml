@model UrbanSolution.Web.Areas.Admin.Models.AdminUsersListingViewModel


@foreach (var user in Model.Users)
{
    var userAddToRoles = Model.AllRoles.Where(r => !user.UserRoles.Contains(r.Text));
    var userRemoveFromRoles = Model.AllRoles.Where(r => user.UserRoles.Contains(r.Text));

    <tr>
        <td class="text-center">@user.UserName</td>
        <td class="text-center">@user.Email</td>
        <td class="text-center">@user.LockoutEnd</td>
        <td>
            @if (user.LockoutEnd != null)
            {
                <form asp-controller="Users" asp-action="Unlock" method="post">
                    <input type="hidden" name="UserId" value="@user.Id" />
                    <div class="form-inline text-center">
                        <input class="btn btn-sm btn-success" type="submit" value="Unlock" />
                    </div>
                </form>
            }
            else
            {
                <form asp-controller="Users" asp-action="Lock" method="post">
                    <input type="hidden" name="UserId" value="@user.Id" />
                    <div class="form-inline text-center">
                        <select name="LockDays" asp-items="Model.LockDays" class="form-control"></select>
                        <button class="btn btn-sm btn-danger" type="submit" value="Lock"><i class="glyphicon glyphicon-lock"></i></button>
                    </div>

                </form>
            }

        </td>
        @*AddToRole*@
        <td>
            @if (userAddToRoles.Any())
            {
                <form asp-controller="Users" asp-action="AddToRole" method="post">
                    <div class="form-inline text-center">
                        <input type="hidden" name="UserId" value="@user.Id" />
                        <select name="Role" asp-items="userAddToRoles" class="form-control"></select>
                        <button class="btn btn-sm btn-success" type="submit" value="Add">
                            <i class="glyphicon glyphicon-ok"></i>
                        </button>
                    </div>
                </form>
            }
        </td>
        @*RemoveFromRole*@
        <td>
            @if (userRemoveFromRoles.Any())
            {
                <form asp-controller="Users" asp-action="RemoveFromRole" method="post">
                    <div class="col-md-8">
                        <input type="hidden" name="UserId" value="@user.Id" />
                        <select name="Role" asp-items="userRemoveFromRoles" class="form-control"></select>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-sm btn-danger" type="submit" value="Remove">
                            <i class="glyphicon glyphicon-remove"></i>
                        </button>
                    </div>
                </form>
            }
        </td>
    </tr>
}